Day18.动态规划系列答疑篇

# 零、前言

## 更新日志：

> 2024-4-23：阅读了 v5.2 的 一、最优子结构详解 & 二、如何一眼看出重叠子问题 的 PDF；总结了 零、前言 & 一、最优子结构详解。

## 1.本文主要内容：

这篇文章就给你讲明白以下几个问题：

1、到底**什么才叫「最优子结构」，和动态规划什么关系**。

2、**如何判断**一个**问题是动态规划问题**，即**如何看出是否存在重叠子问题**。

3、**为什么**经常看到将 **dp 数组**的**大小**设置为 **n + 1 而不是 n**。

4、**为什么动态规划遍历 dp 数组**的**方式五花八门**，有的**正着**遍历，有的**倒着**遍历，有的**斜着**遍历。

# 一、最优子结构详解

> 很多问题其实都具有「最优子结构」，只是其中大部分不具有重叠子问题，所以我们不把它们归为动态规划系列问题而已。

## 举例子（易理解）：

- 假设你们学校有 **10 个班**，你已经计算出了**每个班的最高考试成绩**。那么现在我要求你**计算全校最高的成绩**，你会不会算？当然会，而且你不用重新遍历全校学生的分数进行比较，而是只要在这 **10 个最高成绩**中**取最大**的就是**全校的最高成绩**。

### 符合最优子结构：

- 可以从**子问题的最优结果推出更大规模问题的最优结果**。
- 让你算**每个班的最优成绩就是子问题**，你知道**所有子问题的答案**后，就可以**借此推出**全校学生的最优成绩这个**规模更大的问题的答案**。
- **显然没有重叠子问题**，所以简单地求最值肯定不用动态规划。

## 举例子：

- 假设你们学校有 10 个班，你已知每个班的**最大分数差**（最高分和最低分的差值）。那么现在我让你计算全校学生中的最大分数差，你会不会算？可以想办法算，但是肯定不能通过已知的这 10 个班的最大分数差推到出来。因为这 **10 个班的最大分数差不一定**就包含**全校学生的最大分数差**，比如全校的最大分数差可能是 3 班的最高分和 6 班的最低分之差。

### 不符合最优子结构：

因为你**没办法**通过**每个班的最优值推出全校的最优值**，**没办法通过子问题的最优值推出规模更大的问题的最优值**。前文 动态规划详解 说过，**想满足最优子结，子问题之间必须互相独立**。全校的**最大分数差可能出现在两个班之间，显然子问题不独立**，所以这个问题本身不符合最优子结构。

## 最优子结构失效：改造问题

对于最大分数差，没办法利用已知的每个班的分数差吗，**写一段暴力代码**：

```js
let result = 0
for (let a in school) {
  for (let b in school) {
    if (a === b) continue
    result = Math.max(result, Math.abs(a.score - b.score))
  }
}
return result
```

### 改造问题——问题等价转化：

- 最大分数差，等价于，最高分数和最低分数的差，=**求最高和最低分数**，=第一个问题=具有最优子结构。
- 改变思路，借助最优子结构解决最值问题，  
  再回头解决最大分数差问题，高效多了

## 动态规划问题，一直在求各种最值，

- 本质跟举的例子没区别，无非需要处理一下重叠子问题。

前文不 同定义不同解法 和 高楼扔鸡蛋问题 就展示了如何改造问题，不同的最优子结构，可能导致不同的解法和效率。

## 举例子（求一棵二叉树的最大值）：

简单起见，假设节点中的值都是非负数：

```js
var maxVal = function (root) {
  if (root == null) return -1
  var left = maxVal(root.left)
  var right = maxVal(root.right)
  return max(root.val, left, right)
}
```

### 符合最优子结构

- 以 root 为根的树的最大值，可以通过**两边子树（子问题）的最大值推导出来**，结合刚才学校和班级的例子，很容易理解吧。

### 也不是动态规划问题

- 旨在说明，**最优子结构并不是动态规划独有的一种性质**，能求最值的问题大部分都具有这个性质；

- 但反过来，**最优子结构性质作为动态规划问题的必要条件，一定是让你求最值的**，以后碰到那种恶心人的**最值题，思路往动态规划想**就对了，这就是**套路**。

## 动态规划想象成链式反应

- 动态规划就是**从最简单的 base case 往后推导**，可以想象成一个**链式反应**，以小博大。
- 但只有**符合最优子结构的问题**，才有发生这种**链式反应**的性质。

## 符合最优子结构的问题才发生链式反应

1. **找最优子结构**的过程，其实就是**证明状态转移方程正确性**的过程，
2. **方程符合最优子结构**就可以写**暴力解**了，
3. **写出暴力解**就可以看出**有没有重叠子问题**了，**有则优化**，无则 OK。这也是**套路**，经常刷题的读者应该能体会。

这里就不举那些正宗动态规划的例子了，读者可以翻翻历史文章，**看看状态转移是如何遵循最优子结构**的，这个话题就聊到这，下面再来看其他的动态规划迷惑行为。

# 二、如何一眼看出重叠子问题【to do】

# 三、dp 数组的大小设置

# 四、dp 数组的遍历方向

# 总结

Day18.动态规划系列答疑篇

## 更新日志：

> 2024-4-23：阅读了 v5.2 的 一、最优子结构详解 & 二、如何一眼看出重叠子问题 的 PDF；总结了 零、前言 & 一、最优子结构详解。

## 【收获 1】

【1】今天学习了 **动态规划系列答疑篇** 技巧，得知：

动态规划想象成链式反应

符合最优子结构的问题才发生链式反应

1. **找最优子结构**的过程，其实就是**证明状态转移方程正确性**的过程，
2. **方程符合最优子结构**就可以写**暴力解**了，
3. **写出暴力解**就可以看出**有没有重叠子问题**了，**有则优化**，无则 OK。这也是**套路**，经常刷题的读者应该能体会。

## 【收获 2】

今天输出了一篇打卡文章总结：

- [Day18.动态规划系列答疑篇](https://github.com/djsz3y/algorithm-labuladong/blob/master/Day18.动态规划系列答疑篇.md)

# 参考链接

- [LABULADONG 的算法网站](https://labuladong.online/algo/)
